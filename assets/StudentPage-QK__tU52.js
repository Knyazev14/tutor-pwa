import{r as c,j as e,u as z,a as Q,R as w,L,B as S}from"./index-CxWwzzE3.js";import{S as j}from"./student.api-Dd7ZWYGw.js";const I=()=>{const[t,i]=c.useState([]),[d,s]=c.useState(!1),[g,a]=c.useState(null),x=c.useCallback(async()=>{s(!0),a(null);try{const r=await j.getAll();return i(r.data),r.data}catch(r){const o=r.response?.data?.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð¾Ð²";throw a(o),r}finally{s(!1)}},[]),n=c.useCallback(async r=>{s(!0),a(null);try{return(await j.getById(r)).data}catch(o){const u=o.response?.data?.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð°";throw a(u),o}finally{s(!1)}},[]),l=c.useCallback(async r=>{s(!0),a(null);try{const o=await j.create(r);return await x(),o.data}catch(o){const u=o.response?.data?.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð°";throw a(u),o}finally{s(!1)}},[x]),h=c.useCallback(async(r,o)=>{s(!0),a(null);try{const u=await j.update(r,o);return await x(),u.data}catch(u){const f=u.response?.data?.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð°";throw a(f),u}finally{s(!1)}},[x]),b=c.useCallback(async r=>{s(!0),a(null);try{await j.delete(r),await x()}catch(o){const u=o.response?.data?.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ ÑÑ‚ÑƒÐ´ÐµÐ½Ñ‚Ð°";throw a(u),o}finally{s(!1)}},[x]);return{students:t,loading:d,error:g,fetchStudents:x,getStudent:n,createStudent:l,updateStudent:h,deleteStudent:b}},O=t=>{const[i,d]=c.useState(""),[s,g]=c.useState("name"),a=c.useMemo(()=>{if(!t.length)return[];let n=[...t];if(i){const l=i.toLowerCase();n=n.filter(h=>h.name?.toLowerCase().includes(l)||h.comment?.toLowerCase().includes(l))}return n.sort((l,h)=>{switch(s){case"name":return(l.name||"").localeCompare(h.name||"");case"date":return new Date(h.createdAt||0)-new Date(l.createdAt||0);case"lessons":return(h.lessonsCount||0)-(l.lessonsCount||0);default:return 0}}),n},[t,i,s]),x=c.useMemo(()=>({total:t.length,withBooks:t.filter(n=>n.bookingsCount>0).length,withLessons:t.filter(n=>n.lessonsCount>0).length,totalBookings:t.reduce((n,l)=>n+(l.bookingsCount||0),0),totalLessons:t.reduce((n,l)=>n+(l.lessonsCount||0),0)}),[t]);return{searchQuery:i,setSearchQuery:d,sortBy:s,setSortBy:g,filteredStudents:a,stats:x}};function R({student:t,onEdit:i,onDelete:d}){const[s,g]=c.useState(!1);return e.jsxs("div",{className:"relative border-2 rounded-xl p-5 transition-all duration-300 bg-white border-gray-200 hover:shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded-full",children:["#",t.id]})}),e.jsx("button",{onClick:()=>g(!s),className:"text-gray-500 hover:text-gray-700 transition-colors",children:s?"â–¼":"â–¶"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xl",children:"ðŸ‘¤"}),e.jsx("div",{children:e.jsx("h3",{className:"font-bold text-lg",children:t.name||"Ð‘ÐµÐ· Ð¸Ð¼ÐµÐ½Ð¸"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"bg-blue-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-blue-600 font-bold",children:t.bookingsCount||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Ð‘Ñ€Ð¾Ð½ÐµÐ¹"})]}),e.jsxs("div",{className:"bg-green-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-green-600 font-bold",children:t.lessonsCount||0}),e.jsx("div",{className:"text-xs text-gray-600",children:"Ð£Ñ€Ð¾ÐºÐ¾Ð²"})]})]}),t.comment&&e.jsxs("div",{className:"text-sm text-gray-500 italic border-t pt-2 mt-2",children:["ðŸ“ ",t.comment]}),s&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-gray-200 flex gap-2",children:[i&&e.jsx("button",{onClick:()=>i(t),className:"flex-1 py-2 px-3 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium",children:"âœï¸ Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"}),d&&e.jsx("button",{onClick:()=>d(t.id),className:"flex-1 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-sm font-medium",children:"ðŸ—‘ï¸ Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"})]})]})]})}function q({isOpen:t,onClose:i,onSubmit:d,student:s}){const[g,a]=c.useState({name:"",comment:""});if(c.useEffect(()=>{a(s?{name:s.name||"",comment:s.comment||""}:{name:"",comment:""})},[s]),!t)return null;const x=l=>{l.preventDefault(),d(g)},n=l=>{const{name:h,value:b}=l.target;a(r=>({...r,[h]:b}))};return e.jsx("div",{className:"fixed inset-0 bg-sky-100/70 flex items-start md:items-center justify-center z-50 p-4 overflow-y-auto overflow-x-hidden",children:e.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:s?"âœï¸ Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ°":"âž• ÐÐ¾Ð²Ñ‹Ð¹ ÑƒÑ‡ÐµÐ½Ð¸Ðº"}),e.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-700",children:"âœ•"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ðŸ‘¤ Ð˜Ð¼Ñ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ° *"}),e.jsx("input",{type:"text",name:"name",value:g.name,onChange:n,required:!0,placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð˜Ð²Ð°Ð½ ÐŸÐµÑ‚Ñ€Ð¾Ð²",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ðŸ“ ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹"}),e.jsx("textarea",{name:"comment",value:g.comment,onChange:n,rows:"3",placeholder:"Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐµ...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:s?"Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ":"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ"}),e.jsx("button",{type:"button",onClick:i,className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors",children:"ÐžÑ‚Ð¼ÐµÐ½Ð°"})]})]})]})})})}function G(){const t=z(),{isAuthenticated:i}=Q(),{students:d,loading:s,error:g,fetchStudents:a,createStudent:x,updateStudent:n,deleteStudent:l}=I(),{searchQuery:h,setSearchQuery:b,sortBy:r,setSortBy:o,filteredStudents:u,stats:f}=O(d),[B,y]=w.useState(!1),[N,v]=w.useState(null),[E,C]=w.useState(!1);c.useEffect(()=>{if(!i){t("/login");return}a()},[i,t,a]);const k=()=>{v(null),y(!0)},M=m=>{v(m),y(!0)},A=async m=>{if(window.confirm("Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹, Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ ÑƒÐ´Ð°Ð»Ð¸Ñ‚ÑŒ ÑÑ‚Ð¾Ð³Ð¾ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ°?"))try{await l(m),alert("âœ… Ð£Ñ‡ÐµÐ½Ð¸Ðº ÑƒÐ´Ð°Ð»ÐµÐ½")}catch(p){alert("âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: "+p.message)}},D=async m=>{C(!0);try{const p={name:m.name,comment:m.comment||null};N?(await n(N.id,p),alert("âœ… Ð£Ñ‡ÐµÐ½Ð¸Ðº ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½")):(await x(p),alert("âœ… Ð£Ñ‡ÐµÐ½Ð¸Ðº ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°Ð½")),y(!1),v(null)}catch(p){alert("âŒ ÐžÑˆÐ¸Ð±ÐºÐ°: "+p.message)}finally{C(!1)}};return s&&!d.length?e.jsx(L,{fullScreen:!0}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:["ðŸ‘¥ Ð£Ñ‡ÐµÐ½Ð¸ÐºÐ¸",e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",u.length," Ð¸Ð· ",d.length,")"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{onClick:k,variant:"success",icon:e.jsx("span",{children:"âž•"}),size:"sm",children:"ÐÐ¾Ð²Ñ‹Ð¹ ÑƒÑ‡ÐµÐ½Ð¸Ðº"}),e.jsx(S,{onClick:a,disabled:s,variant:"primary",icon:e.jsx("span",{children:"ðŸ”„"}),size:"sm",children:"ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600",children:"Ð’ÑÐµÐ³Ð¾ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ¾Ð²"}),e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:f.total})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600",children:"Ð¡ Ð±Ñ€Ð¾Ð½ÑÐ¼Ð¸"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:f.withBooks})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-purple-600",children:"Ð¡ ÑƒÑ€Ð¾ÐºÐ°Ð¼Ð¸"}),e.jsx("div",{className:"text-2xl font-bold text-purple-700",children:f.withLessons})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-orange-600",children:"Ð’ÑÐµÐ³Ð¾ ÑƒÑ€Ð¾ÐºÐ¾Ð²"}),e.jsx("div",{className:"text-2xl font-bold text-orange-700",children:f.totalLessons})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"ðŸ” ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸ Ð¸Ð»Ð¸ ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸ÑŽ...",value:h,onChange:m=>b(m.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("select",{value:r,onChange:m=>o(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"name",children:"ÐŸÐ¾ Ð¸Ð¼ÐµÐ½Ð¸"}),e.jsx("option",{value:"date",children:"ÐŸÐ¾ Ð´Ð°Ñ‚Ðµ"}),e.jsx("option",{value:"lessons",children:"ÐŸÐ¾ ÑƒÑ€Ð¾ÐºÐ°Ð¼"})]})})]}),g&&e.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg",children:["âŒ ",g]}),u.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(m=>e.jsx(R,{student:m,onEdit:M,onDelete:A},m.id))}):!s&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-gray-500 text-lg",children:d.length===0?"ðŸ“­ ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¾Ð± ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ°Ñ…":"ðŸ” ÐÐµÑ‚ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ¾Ð² Ð¿Ð¾ Ð²Ð°ÑˆÐµÐ¼Ñƒ Ð·Ð°Ð¿Ñ€Ð¾ÑÑƒ"}),d.length===0&&e.jsx(S,{onClick:k,variant:"success",className:"mt-4",children:"âž• Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ ÑƒÑ‡ÐµÐ½Ð¸ÐºÐ°"})]}),e.jsx(q,{isOpen:B,onClose:()=>{y(!1),v(null)},onSubmit:D,student:N}),E&&e.jsx("div",{className:"fixed inset-0 bg-sky-100/70 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white p-4 rounded-lg",children:e.jsx(L,{})})})]})}export{G as default};
//# sourceMappingURL=StudentPage-QK__tU52.js.map
