import{r as d,j as e}from"./index-DxFZvIyj.js";import{L as f}from"./lesson.api-CFvht95z.js";const D=()=>{const[x,b]=d.useState([]),[h,t]=d.useState(!1),[p,l]=d.useState(null),c=d.useCallback(async()=>{t(!0),l(null);try{const a=await f.getAll();return b(a.data),a.data}catch(a){const r=a.response?.data?.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–æ–≤";throw l(r),a}finally{t(!1)}},[]),s=d.useCallback(async a=>{t(!0),l(null);try{return(await f.getById(a)).data}catch(r){const n=r.response?.data?.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–∞";throw l(n),r}finally{t(!1)}},[]),g=d.useCallback(async a=>{t(!0),l(null);try{console.log("üì§ Creating lesson with data:",a);const r=await f.create(a);return console.log("üì• Create response:",r.data),await c(),r.data}catch(r){console.error("‚ùå Create error:",{status:r.response?.status,data:r.response?.data,message:r.message});const n=r.response?.data?.message||"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —É—Ä–æ–∫–∞";throw l(n),r}finally{t(!1)}},[c]),y=d.useCallback(async(a,r)=>{t(!0),l(null);try{console.log("üì§ Updating lesson:",a,"with data:",r);const n=await f.update(a,r);return console.log("üì• Update response:",n.data),await c(),n.data}catch(n){console.error("‚ùå Update error:",{status:n.response?.status,data:n.response?.data,message:n.message});const i=n.response?.data?.message||"–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞";throw l(i),n}finally{t(!1)}},[c]),o=d.useCallback(async a=>{t(!0),l(null);try{console.log("üóëÔ∏è Deleting lesson:",a),await f.delete(a),await c()}catch(r){console.error("‚ùå Delete error:",{status:r.response?.status,data:r.response?.data,message:r.message});const n=r.response?.data?.message||"–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞";throw l(n),r}finally{t(!1)}},[c]);return{lessons:x,loading:h,error:p,fetchLessons:c,getLesson:s,createLesson:g,updateLesson:y,deleteLesson:o}};function N({isOpen:x,onClose:b,onSubmit:h,lesson:t,students:p,categories:l,statuses:c}){const[s,g]=d.useState({name:"",startDate:"",endDate:"",timeFrom:"",timeTo:"",price:"",studentId:"",categoryId:"",statusId:"",lessonFormat:"offline"});if(d.useEffect(()=>{if(t){console.log("Setting lesson data:",t);let a="",r="",n="",i="";if(t.startDate)if(t.startDate.includes("T")){const[u,m]=t.startDate.split("T");a=u,n=m}else if(t.startDate.includes(" ")){const[u,m]=t.startDate.split(" ");a=u,n=m.substring(0,5)}else a=t.startDate;if(t.endDate)if(t.endDate.includes("T")){const[u,m]=t.endDate.split("T");r=u,i=m}else if(t.endDate.includes(" ")){const[u,m]=t.endDate.split(" ");r=u,i=m.substring(0,5)}else r=t.endDate;g({name:t.name||"",startDate:a||t.date||"",endDate:r||t.endDatePart||"",timeFrom:n||t.timeFrom||"",timeTo:i||t.timeTo||"",price:t.price||"",studentId:t.student?.id||"",categoryId:t.category?.id||"",statusId:t.lessonStatus?.id||t.status?.id||"",lessonFormat:t.lessonFormat||"offline"})}else g({name:"",startDate:"",endDate:"",timeFrom:"",timeTo:"",price:"",studentId:"",categoryId:"",statusId:"",lessonFormat:"offline"})},[t]),d.useEffect(()=>{if(x&&s.studentId&&s.categoryId&&!s.name){const a=p?.find(n=>n.id===parseInt(s.studentId)),r=l?.find(n=>n.id===parseInt(s.categoryId));a&&r&&g(n=>({...n,name:`${a.name} - ${r.name}`}))}},[x,s.studentId,s.categoryId,s.name,p,l]),!x)return null;const y=a=>{a.preventDefault();const r=s.startDate&&s.timeFrom?`${s.startDate} ${s.timeFrom}:00`:null,n=s.endDate&&s.timeTo?`${s.endDate} ${s.timeTo}:00`:null,i={name:s.name,startDate:r,endDate:n,price:s.price?parseInt(s.price):0,studentId:parseInt(s.studentId),categoryId:parseInt(s.categoryId),statusId:parseInt(s.statusId),lessonFormat:s.lessonFormat};t?.book?.id&&(i.bookId=t.book.id),console.log("Submitting lesson data:",i),h(i)},o=a=>{const{name:r,value:n}=a.target;g(i=>({...i,[r]:n}))};return e.jsx("div",{className:"fixed inset-0 bg-sky-100/70 flex items-start md:items-center justify-center z-50 p-4 overflow-y-auto overflow-x-hidden",children:e.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:t?"‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–∫":"‚ûï –ù–æ–≤—ã–π —É—Ä–æ–∫"}),e.jsx("button",{onClick:b,className:"text-gray-500 hover:text-gray-700",children:"‚úï"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üìù –ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ *"}),e.jsx("input",{type:"text",name:"name",value:s.name,onChange:o,placeholder:"–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üë§ –£—á–µ–Ω–∏–∫ *"}),e.jsxs("select",{name:"studentId",value:s.studentId,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ —É—á–µ–Ω–∏–∫–∞"}),p?.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üìö –ü—Ä–µ–¥–º–µ—Ç *"}),e.jsxs("select",{name:"categoryId",value:s.categoryId,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–º–µ—Ç"}),l?.map(a=>e.jsxs("option",{value:a.id,children:[a.name," - ",a.price,"—Ä"]},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üìä –°—Ç–∞—Ç—É—Å *"}),e.jsxs("select",{name:"statusId",value:s.statusId,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç—É—Å"}),c?.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üè´ –§–æ—Ä–º–∞—Ç –∑–∞–Ω—è—Ç–∏—è"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"lessonFormat",value:"offline",checked:s.lessonFormat==="offline",onChange:o,className:"mr-2"}),"üè´ –û—Ñ–ª–∞–π–Ω"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"lessonFormat",value:"online",checked:s.lessonFormat==="online",onChange:o,className:"mr-2"}),"üíª –û–Ω–ª–∞–π–Ω"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üìÖ –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ *"}),e.jsx("input",{type:"date",name:"startDate",value:s.startDate,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üìÖ –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è"}),e.jsx("input",{type:"date",name:"endDate",value:s.endDate,onChange:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º, –µ—Å–ª–∏ —É—Ä–æ–∫ –æ–¥–Ω–æ–¥–Ω–µ–≤–Ω—ã–π"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"‚è∞ –í—Ä–µ–º—è —Å *"}),e.jsx("input",{type:"time",name:"timeFrom",value:s.timeFrom,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"‚è∞ –í—Ä–µ–º—è –¥–æ *"}),e.jsx("input",{type:"time",name:"timeTo",value:s.timeTo,onChange:o,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"üí∞ –¶–µ–Ω–∞"}),e.jsx("input",{type:"number",name:"price",value:s.price,onChange:o,min:"0",placeholder:"–°—Ç–æ–∏–º–æ—Å—Ç—å —É—Ä–æ–∫–∞",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:t?"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å":"–°–æ–∑–¥–∞—Ç—å"}),e.jsx("button",{type:"button",onClick:b,className:"flex-1 bg-gray-100 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-200 transition-colors",children:"–û—Ç–º–µ–Ω–∞"})]})]})]})})})}export{N as L,D as u};
//# sourceMappingURL=LessonModal-BteasoYB.js.map
